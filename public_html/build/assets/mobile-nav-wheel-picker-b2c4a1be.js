class g{constructor(){this.container=null,this.iconsContainer=null,this.items=[],this.centerPoint=0,this.sidePadding=16,this.isInitialized=!1,this.activeIconId=null,this.originalIcons=new Map,this.init(),this.checkEditorPage(),window.addEventListener("popstate",()=>this.checkEditorPage())}init(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.findElements()}):setTimeout(()=>this.findElements(),100)}findElements(){if(this.container=document.getElementById("nav-scroll-container"),this.iconsContainer=document.getElementById("nav-icons-container"),!this.container||!this.iconsContainer){console.warn("MobileNavCore: ÐÐµ Ð²ÑÐµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹, Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð°Ñ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ° Ñ‡ÐµÑ€ÐµÐ· 500ms"),setTimeout(()=>this.findElements(),500);return}this.items=Array.from(this.iconsContainer.querySelectorAll(".mb-icon-wrapper")),this.calculateCenterPoint(),this.items.length>0&&(this.isInitialized=!0,console.log("MobileNavCore: ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°"))}calculateCenterPoint(){this.centerPoint=this.container?this.container.offsetWidth/2:0}hideNavigation(){const t=document.querySelector(".mb-navigation");t&&t.classList.add("mb-nav-hidden")}showNavigation(){const t=document.querySelector(".mb-navigation");t&&t.classList.remove("mb-nav-hidden")}convertIconToBackButton(t){if(!this.isInitialized)return!1;this.activeIconId&&this.activeIconId!==t&&this.restoreIcon(this.activeIconId);const e=this.items.find(s=>s.getAttribute("data-icon-id")===t);if(!e)return console.warn(`MobileNavCore: Ð˜ÐºÐ¾Ð½ÐºÐ° Ñ ID ${t} Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°`),!1;const i=e.querySelector("a"),o=e.querySelector(".mb-nav-icon");return i&&o?(this.originalIcons.has(t)||this.originalIcons.set(t,{link:i.getAttribute("href"),img:o.getAttribute("src"),classes:e.className,linkClasses:i.className}),i.setAttribute("href","javascript:void(0);"),i.classList.add("mb-nav-back-btn"),o.setAttribute("src","/images/icons/arrow-left.svg"),e.classList.add("back-button-active"),i._closeModalHandler&&i.removeEventListener("click",i._closeModalHandler),i._closeModalHandler=s=>(s.preventDefault(),s.stopPropagation(),console.log('ÐÐ°Ð¶Ð°Ñ‚Ð° ÐºÐ½Ð¾Ð¿ÐºÐ° "ÐÐ°Ð·Ð°Ð´" Ð´Ð»Ñ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¼Ð¾Ð´Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾ÐºÐ½Ð°'),window.modalPanel&&window.modalPanel.closeModal(),!1),i.addEventListener("click",i._closeModalHandler),i.onclick=i._closeModalHandler,this.activeIconId=t,!0):!1}restoreIcon(t){if(!this.isInitialized||!this.originalIcons.has(t))return!1;const e=this.items.find(n=>n.getAttribute("data-icon-id")===t);if(!e)return console.warn(`MobileNavCore: Ð˜ÐºÐ¾Ð½ÐºÐ° Ñ ID ${t} Ð´Ð»Ñ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°`),!1;const i=this.originalIcons.get(t),o=e.querySelector("a"),s=e.querySelector(".mb-nav-icon");return o&&s&&i?(o._closeModalHandler&&(o.removeEventListener("click",o._closeModalHandler),delete o._closeModalHandler),o.setAttribute("href",i.link),o.className=i.linkClasses,s.setAttribute("src",i.img),e.className=i.classes,o.onclick=null,this.originalIcons.delete(t),this.activeIconId===t&&(this.activeIconId=null),!0):!1}checkEditorPage(){const t=window.location.href;/\/templates\/editor\/\d+/.test(t)||/\/client\/templates\/editor\/\d+/.test(t)?(this.ensureNavigationVisible(),document.documentElement.classList.add("editor-page"),console.log("Ð ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½: "+t)):document.documentElement.classList.remove("editor-page")}ensureNavigationVisible(){const t=document.querySelector(".mb-navigation");t&&(t.style.display="flex",t.classList.remove("mb-nav-hidden"),t.classList.add("mb-nav-force-visible"),console.log("ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð°"))}}class f{constructor(t,e,i){this.core=t,this.scroll=e,this.popup=i,this.touchStartX=0,this.touchStartY=0,this.isTouchMoved=!1,this.isLongPress=!1,this.longPressTimer=null,this.longPressDelay=500,this.activeIconId=null,this.init()}init(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.setupEventListeners()}):setTimeout(()=>this.setupEventListeners(),500)}setupEventListeners(){if(!this.core.isInitialized||!this.core.container){console.warn("MobileNavEvents: Ð¯Ð´Ñ€Ð¾ Ð½Ð°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ð¸ Ð½Ðµ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾");return}this.setupModalListeners(),this.setupTouchEvents(),this.setupClickEvents(),console.log("MobileNavEvents: Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹")}setupModalListeners(){if(document.addEventListener("modal.opened",t=>{var o,s;const e=(o=t.detail)==null?void 0:o.modalId;let i=(s=t.detail)==null?void 0:s.sourceIconId;if(!i&&e&&this.popup.modalTriggers.has(e)&&(i=this.popup.modalTriggers.get(e).iconId),console.log("âš¡ï¸ Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ modal.opened Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¾:",{modalId:e,sourceIconId:i}),e&&i){this.activeIconId===i?(console.log(`ðŸ”„ ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´Ð»Ñ Ð¸ÐºÐ¾Ð½ÐºÐ¸ ${i}`),this.core.restoreIcon(i)):console.log(`ðŸ”„ ÐŸÑ€ÐµÐ¾Ð±Ñ€Ð°Ð·ÑƒÐµÐ¼ Ð¸ÐºÐ¾Ð½ÐºÑƒ ${i} Ð² ÐºÐ½Ð¾Ð¿ÐºÑƒ "Ð½Ð°Ð·Ð°Ð´" Ð´Ð»Ñ Ð¼Ð¾Ð´Ð°Ð»ÐºÐ¸ ${e}`),this.activeIconId=i;const n=this.core.convertIconToBackButton(i);console.log(`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ñ: ${n?"ÑƒÑÐ¿ÐµÑˆÐ½Ð¾":"Ð¾ÑˆÐ¸Ð±ÐºÐ°"}`)}}),document.addEventListener("modal.closed",t=>{var i;const e=(i=t.detail)==null?void 0:i.modalId;if(console.log("âš¡ï¸ Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ modal.closed Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¾:",{modalId:e,activeIconId:this.activeIconId}),e&&this.activeIconId){console.log(`ðŸ”„ Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð¸ÐºÐ¾Ð½ÐºÑƒ ${this.activeIconId}`);const o=this.core.restoreIcon(this.activeIconId);console.log(`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ: ${o?"ÑƒÑÐ¿ÐµÑˆÐ½Ð¾":"Ð¾ÑˆÐ¸Ð±ÐºÐ°"}`),this.activeIconId=null}}),window.modalPanel&&!window.modalPanel._methodsModified){const t=window.modalPanel.openModal,e=window.modalPanel.closeModal;window.modalPanel.openModal=i=>{const o=t.call(window.modalPanel,i);if(o){let s=null;if(window.modalPanel.modalSources&&window.modalPanel.modalSources.has(i)?s=window.modalPanel.modalSources.get(i):this.popup&&this.popup.modalTriggers.has(i)&&(s=this.popup.modalTriggers.get(i)),s&&s.iconId){const n=new CustomEvent("modal.opened",{detail:{modalId:i,sourceIconId:s.iconId}});document.dispatchEvent(n)}}return o},window.modalPanel.closeModal=(i=!1)=>{var s;const o=(s=window.modalPanel.activeModal)==null?void 0:s.id;if(e.call(window.modalPanel,i),o){const n=new CustomEvent("modal.closed",{detail:{modalId:o}});document.dispatchEvent(n)}},window.modalPanel._methodsModified=!0}}setupTouchEvents(){this.core.container.addEventListener("touchstart",t=>{this.touchStartX=t.touches[0].clientX,this.touchStartY=t.touches[0].clientY,this.isTouchMoved=!1;const e=document.elementFromPoint(this.touchStartX,this.touchStartY),i=e?e.closest(".mb-icon-wrapper"):null;i&&(i.classList.add("mb-touch-active"),this.longPressTimer&&clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.isTouchMoved||(this.isLongPress=!0,this.handleLongPress(i))},this.longPressDelay))},{passive:!0}),this.core.container.addEventListener("touchmove",t=>{if(this.longPressTimer){const e=t.touches[0].clientX,i=t.touches[0].clientY,o=Math.abs(e-this.touchStartX),s=Math.abs(i-this.touchStartY);(o>10||s>10)&&(this.isTouchMoved=!0,clearTimeout(this.longPressTimer),this.longPressTimer=null,document.querySelectorAll(".mb-touch-active").forEach(n=>{n.classList.remove("mb-touch-active")}))}},{passive:!0}),this.core.container.addEventListener("touchend",t=>{document.querySelectorAll(".mb-touch-active").forEach(e=>{e.classList.remove("mb-touch-active")}),this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.isLongPress=!1},{passive:!0})}setupClickEvents(){document.querySelectorAll('.mb-icon-wrapper[data-modal="true"]').forEach(e=>{const i=e.getAttribute("data-modal-target"),o=e.getAttribute("data-icon-id");i&&o&&(this.popup.modalTriggers.set(i,{element:e,iconId:o}),o==="qr-scanner"&&e.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),console.log("QR Scanner ÐºÐ»Ð¸Ðº Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½ Ð² MobileNavEvents"),window.openQrScannerModal?window.openQrScannerModal(e):window.modalPanel&&window.modalPanel.openModal(i)}))})}handleLongPress(t){const e=t.getAttribute("data-icon-id");if(e){if(t.classList.add("mb-long-press"),navigator.vibrate)try{navigator.vibrate(50)}catch{}setTimeout(()=>{this.popup.showPopup(e),t.classList.remove("mb-long-press")},300)}}}class v{constructor(t){this.core=t,this.isScrolling=!1,this.scrollTimeout=null,this.animationFrame=null,this.isCentering=!1,this.centeringQueue=[],this.lastDebounceTime=0,this.debounceThreshold=150,this.lastScrollLeft=0,this.scrollDirection=0,this.debounceTimeout=null,this.lastPageScroll=0,this.pageScrollTimeout=null,this.pageScrollThreshold=10,this.hideNavigationTimeout=null,this.isNavigationHidden=!1,this.lastUserActionTime=Date.now(),this.inactivityTimeout=null,this.inactivityThreshold=1500,this.inertiaEnabled=!0,this.inertiaFactor=.92,this.inertiaThreshold=.5,this.momentumValue=0,this.rafId=null,this.userHasInteracted=!1,this.initUserInteractionTracking(),this.lastScrollTime=0,this.setupScrollTimeTracking()}setupScrollTimeTracking(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.setupScrollListener()}):setTimeout(()=>this.setupScrollListener(),100)}setupScrollListener(){this.core&&this.core.container?this.core.container.addEventListener("scroll",()=>{this.lastScrollTime=Date.now()},{passive:!0}):setTimeout(()=>this.setupScrollListener(),500)}applyInertia(t){if(!this.inertiaEnabled||Math.abs(t)<this.inertiaThreshold)return;this.momentumValue=t*15,this.rafId&&cancelAnimationFrame(this.rafId);const e=()=>{this.core.container.scrollLeft+=this.momentumValue,this.momentumValue*=this.inertiaFactor,Math.abs(this.momentumValue)>this.inertiaThreshold?this.rafId=requestAnimationFrame(e):this.rafId=null};this.rafId=requestAnimationFrame(e)}getMaxScrollLeft(){const t=this.core.container.offsetWidth,e=this.core.iconsContainer.scrollWidth;return Math.max(0,e-t)}setupPageScrollListener(){window.addEventListener("scroll",()=>{this.handlePageScroll()},{passive:!0}),this.setupTouchListeners()}setupTouchListeners(){let t=null,e=null;document.addEventListener("touchstart",i=>{t=i.touches[0].clientY},{passive:!0}),document.addEventListener("touchmove",i=>{if(!t)return;e=i.touches[0].clientY;const o=t-e;o<-30?this.showNavigation():o>30&&this.hideNavigation()},{passive:!0}),document.addEventListener("touchend",()=>{t=null,e=null},{passive:!0})}handlePageScroll(){if(!document.querySelector(".mb-navigation"))return;this.lastUserActionTime=Date.now();const e=window.pageYOffset||document.documentElement.scrollTop;this.pageScrollTimeout&&clearTimeout(this.pageScrollTimeout),this.inactivityTimeout&&clearTimeout(this.inactivityTimeout),e>this.lastPageScroll&&e>this.pageScrollThreshold?this.hideNavigation():e<this.lastPageScroll&&this.showNavigation(),this.pageScrollTimeout=setTimeout(()=>{Date.now()-this.lastUserActionTime>=this.inactivityThreshold&&this.showNavigation()},this.inactivityThreshold),this.setupInactivityDetection(),this.lastPageScroll=e}setupInactivityDetection(){this.inactivityTimeout&&clearTimeout(this.inactivityTimeout),this.inactivityTimeout=setTimeout(()=>{this.isNavigationHidden&&this.showNavigation()},this.inactivityThreshold)}hideNavigation(){const t=document.querySelector(".mb-navigation");if(!t||this.isNavigationHidden)return;const e=window.location.pathname;if(e.includes("/templates/create-new/")||e.includes("/templates/editor")||e.includes("/client/templates/create-new/")||e.includes("/client/templates/editor")){console.log("Ð¡ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð½Ð°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¾ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€Ð°");return}requestAnimationFrame(()=>{t.classList.add("mb-nav-hidden"),this.isNavigationHidden=!0,this.lastUserActionTime=Date.now(),this.hideNavigationTimeout&&(clearTimeout(this.hideNavigationTimeout),this.hideNavigationTimeout=null),setTimeout(()=>{this.setupInactivityDetection()},100)})}showNavigation(){const t=document.querySelector(".mb-navigation");!t||!this.isNavigationHidden||(this.hideNavigationTimeout&&(clearTimeout(this.hideNavigationTimeout),this.hideNavigationTimeout=null),navigator.vibrate&&this.isNavigationHidden&&navigator.vibrate(5),requestAnimationFrame(()=>{setTimeout(()=>{t.classList.remove("mb-nav-hidden"),this.isNavigationHidden=!1,this.lastUserActionTime=Date.now(),this.inactivityTimeout&&(clearTimeout(this.inactivityTimeout),this.inactivityTimeout=null),this.setupInactivityDetection()},50)}))}registerUserActivity(){this.lastUserActionTime=Date.now(),this.setupInactivityDetection()}setupUserActivityListeners(){["touchstart","touchmove","mousemove","click","keydown","wheel"].forEach(e=>{document.addEventListener(e,()=>{this.registerUserActivity()},{passive:!0})})}canUseVibrateAPI(){return navigator.vibrate&&this.userHasInteracted&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches}initUserInteractionTracking(){const t=["click","touchstart","touchmove","mousedown","keydown"],e=()=>{this.userHasInteracted=!0,t.forEach(i=>{document.removeEventListener(i,e,{passive:!0})})};t.forEach(i=>{document.addEventListener(i,e,{passive:!0})})}}class w{constructor(t){this.core=t,this.isPopupOpen=!1,this.currentPopupConfig=null,this.popupContainer=null,this.backdrop=null,this.swipeStartY=0,this.swipeStartX=0,this.isSwipeDetected=!1,this.minSwipeDistance=50,this.isUpSwipeInProgress=!1,this.popupConfigs={},this.userHasInteracted=!1,this.swipeTargetElement=null,this.swipeTargetIconId=null,this.modalTriggers=new Map,this.originalBodyOverflow="",this.originalBodyPosition="",this.scrollY=0,this.init()}init(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.delayedInit()}):this.delayedInit()}delayedInit(){setTimeout(()=>{this.createPopupElements(),this.loadPopupConfigsFromHtml(),this.setupSwipeDetection()},500)}loadPopupConfigsFromHtml(){const t=document.getElementById("mobile-nav-popup-configs");if(!t){console.warn("Ð­Ð»ÐµÐ¼ÐµÐ½Ñ‚ #mobile-nav-popup-configs Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð·Ð°Ð¿Ð°ÑÐ½Ñ‹Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸"),this.popupConfigs=this.getFallbackPopupConfigs();return}t.querySelectorAll("[data-popup-config]").forEach(i=>{var a;const o=i.getAttribute("data-popup-config"),s=((a=i.querySelector(".popup-config-title"))==null?void 0:a.textContent)||"",n=[];i.querySelectorAll(".popup-item").forEach(l=>{const d=l.getAttribute("data-icon"),h=l.getAttribute("data-href")||"#",u=l.getAttribute("data-modal")==="true",p=l.getAttribute("data-modal-target")||null,m=l.getAttribute("data-title")||"";n.push({icon:d,href:h,title:m,isModal:u,modalId:p})}),n.length>0&&(this.popupConfigs[o]={title:s,items:n})}),Object.keys(this.popupConfigs).length===0&&(this.popupConfigs=this.getFallbackPopupConfigs())}getFallbackPopupConfigs(){return{home:{title:"Ð“Ð»Ð°Ð²Ð½Ð°Ñ",items:[{icon:"newspaper.svg",href:"/news",isModal:!1,title:"ÐÐ¾Ð²Ð¾ÑÑ‚Ð¸"},{icon:"calendar.svg",href:"/events",isModal:!1,title:"Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ"},{icon:"info-circle.svg",href:"/about",isModal:!1,title:"Ðž Ð½Ð°Ñ"}]},profile:{title:"ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ",items:[{icon:"gear.svg",href:"/profile/settings",isModal:!1,title:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"},{icon:"clock-history.svg",href:"/user/templates",isModal:!1,title:"Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ"},{icon:"heart.svg",href:"/user/favorites",isModal:!1,title:"Ð˜Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ"}]},create:{title:"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ",items:[{icon:"file-earmark.svg",href:"/client/templates/categories",isModal:!1,title:"Ð¨Ð°Ð±Ð»Ð¾Ð½Ñ‹"},{icon:"folder-plus.svg",href:"/client/projects",isModal:!1,title:"ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹"},{icon:"image.svg",href:"/client/images",isModal:!1,title:"Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ"}]},games:{title:"Ð Ð°Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ",items:[{icon:"puzzle.svg",href:"/games/puzzle",isModal:!1,title:"ÐŸÐ°Ð·Ð»Ñ‹"},{icon:"controller.svg",href:"/games/arcade",isModal:!1,title:"ÐÑ€ÐºÐ°Ð´Ñ‹"},{icon:"trophy.svg",href:"/games/tournaments",isModal:!1,title:"Ð¢ÑƒÑ€Ð½Ð¸Ñ€Ñ‹"}]},email:{title:"ÐŸÐ¾Ñ‡Ñ‚Ð°",items:[{icon:"inbox.svg",href:"/email/inbox",isModal:!1,title:"Ð’Ñ…Ð¾Ð´ÑÑ‰Ð¸Ðµ"},{icon:"send.svg",href:"/email/sent",isModal:!1,title:"ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ"},{icon:"pencil.svg",href:"/email/compose",isModal:!1,title:"ÐÐ°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ"}]},admin:{title:"ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ",items:[{icon:"people.svg",href:"/admin/users",isModal:!1,title:"ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸"},{icon:"bar-chart.svg",href:"/admin/statistics",isModal:!1,title:"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°"},{icon:"gear.svg",href:"/admin/settings",isModal:!1,title:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"}]},"qr-scanner":{title:"QR Ð¡ÐºÐ°Ð½ÐµÑ€",items:[{icon:"qr-code.svg",href:"#",isModal:!0,modalId:"qr-scanner-modal",title:"Ð¡ÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"},{icon:"camera.svg",href:"#",isModal:!0,modalId:"camera-modal",title:"ÐšÐ°Ð¼ÐµÑ€Ð°"},{icon:"image.svg",href:"/qr/history",isModal:!1,title:"Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ"}]}}}createPopupElements(){this.backdrop=document.createElement("div"),this.backdrop.className="mb-popup-backdrop",this.popupContainer=document.createElement("div"),this.popupContainer.className="mb-popup-container mb-popup-swipeable";const t=document.createElement("div");t.className="mb-swipe-indicator",this.popupContainer.appendChild(t),document.body.appendChild(this.backdrop),document.body.appendChild(this.popupContainer),this.backdrop.addEventListener("click",()=>this.closePopup()),this.popupContainer.addEventListener("touchstart",e=>{this.swipeStartY=e.touches[0].clientY}),this.popupContainer.addEventListener("touchend",e=>{e.changedTouches[0].clientY-this.swipeStartY>this.minSwipeDistance&&this.closePopup()})}setupSwipeDetection(){if(!this.core.container){const t=document.getElementById("nav-scroll-container");if(t)this.core.container=t;else return}this.core.container.addEventListener("touchstart",t=>{this.userHasInteracted=!0;const e=t.touches[0],i=e.clientX,o=e.clientY,s=Array.from(this.core.iconsContainer.querySelectorAll(".mb-icon-wrapper"));let n=null;for(const c of s){const a=c.getBoundingClientRect();if(i>=a.left&&i<=a.right&&o>=a.top&&o<=a.bottom){n=c;break}}n?(this.swipeTargetElement=n,this.swipeTargetIconId=n.getAttribute("data-icon-id"),this.swipeStartY=o,this.swipeStartX=i,this.isSwipeDetected=!1,this.isUpSwipeInProgress=!1,n.classList.add("mb-touch-active")):(this.swipeTargetElement=null,this.swipeTargetIconId=null,this.swipeStartY=0,this.swipeStartX=0)},{passive:!0}),this.core.container.addEventListener("touchmove",t=>{if(!this.swipeTargetElement||this.swipeStartY===0)return;const e=t.touches[0],i=this.swipeStartY-e.clientY,o=Math.abs(e.clientX-this.swipeStartX);if(i>15&&o<40&&(this.isUpSwipeInProgress=!0,this.swipeTargetElement.classList.contains("swiping-up")||this.swipeTargetElement.classList.add("swiping-up"),i>25&&(this.core.container.style.overflowX="hidden",t.preventDefault(),t.stopPropagation()),i>this.minSwipeDistance&&(this.isSwipeDetected=!0,navigator.vibrate&&this.userHasInteracted&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches)))try{navigator.vibrate(20)}catch{}},{passive:!1}),this.core.container.addEventListener("touchend",t=>{this.core.container.style.overflowX="auto",this.swipeTargetElement&&this.swipeTargetElement.classList.remove("mb-touch-active","swiping-up"),this.isSwipeDetected&&this.swipeTargetIconId&&(console.log(`Ð¡Ð²Ð°Ð¹Ð¿ Ð²Ð²ÐµÑ€Ñ… Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½ Ð½Ð° Ð¸ÐºÐ¾Ð½ÐºÐµ: ${this.swipeTargetIconId}`),this.showPopup(this.swipeTargetIconId)),this.swipeTargetElement=null,this.swipeStartY=0,this.swipeStartX=0,this.isSwipeDetected=!1,this.isUpSwipeInProgress=!1,this.swipeTargetIconId=null})}getCenteredItem(){return null}showPopup(t){const e=this.popupConfigs[t];if(!(!e||this.isPopupOpen)&&(this.currentPopupConfig=e,this.isPopupOpen=!0,this.blockBodyScroll(),this.currentIconId=t,this.renderPopupContent(e,t),requestAnimationFrame(()=>{this.backdrop.style.opacity="1",this.backdrop.style.visibility="visible",this.popupContainer.style.opacity="1",this.popupContainer.style.visibility="visible",this.popupContainer.style.transform="translateX(-50%) translateY(0)"}),navigator.vibrate&&this.userHasInteracted&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches))try{navigator.vibrate(50)}catch{}}renderPopupContent(t,e){this.popupContainer.className="mb-popup-container mb-popup-swipeable",this.popupContainer.classList.add(`popup-for-${e}`),this.getIconTitle(e),this.popupContainer.innerHTML=`
            <div class="mb-swipe-indicator"></div>
           
            <div class="mb-popup-grid">
                ${t.items.map((i,o)=>`
                        <a ${i.isModal?`href="javascript:void(0);" data-modal="true" data-modal-target="${i.modalId}" class="mb-popup-item modal-trigger no-spinner"`:`href="${i.href}" class="mb-popup-item"`} style="animation-delay: ${o*.1}s;">
                            <img src="/images/icons/${i.icon}" 
                                alt="${i.title}" 
                                title="${i.title}"
                                onerror="this.src='/images/icons/placeholder.svg'; this.classList.add('fallback-icon');"
                                onload="this.classList.add('loaded-icon');">
                            <span class="popup-item-title">${i.title}</span>
                        </a>
                    `).join("")}
            </div>
        `,this.ensureAnimationStyles(),this.setupPopupEventListeners()}getIconTitle(t){if(this.popupConfigs[t]&&this.popupConfigs[t].title)return this.popupConfigs[t].title;const e=this.core.iconsContainer.querySelector(`[data-icon-id="${t}"]`);if(e){const i=e.querySelector("img");if(i&&i.alt)return i.alt;const o=e.querySelector("a");if(o&&o.title)return o.title}return t?t.charAt(0).toUpperCase()+t.slice(1):""}setupPopupEventListeners(){this.popupContainer.addEventListener("click",e=>{e.target.closest(".mb-popup-grid")||(e.preventDefault(),this.closePopup())}),this.popupContainer.querySelectorAll(".mb-popup-item").forEach(e=>{e.hasAttribute("data-modal-target")?e.addEventListener("click",i=>{i.preventDefault();const o=e.getAttribute("data-modal-target");console.log("Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ÑÐ²ÑÐ·ÑŒ Ð´Ð»Ñ Ð¼Ð¾Ð´Ð°Ð»ÐºÐ¸",o,"Ñ Ð¸ÐºÐ¾Ð½ÐºÐ¾Ð¹",this.currentIconId),this.modalTriggers.set(o,{element:this.swipeTargetElement,iconId:this.currentIconId}),this.closePopup(),setTimeout(()=>{window.openModalPanel&&window.openModalPanel(o)},300)}):e.addEventListener("click",()=>{this.closePopup()})})}ensureAnimationStyles(){if(!document.querySelector("#mb-popup-animations")){const t=document.createElement("style");t.id="mb-popup-animations",t.textContent=`
                .mb-popup-item {
                      transform: translateY(20px);
    opacity: 0;
    animation: slideUpFade 0.3s ease forwards;
    display: flex
;
    flex-direction: row;
    align-items: center;
    gap: 5px;
    align-content: center;
    justify-content: flex-start;
                }
                .popup-item-title {
                   font-size: 16px;
    text-align: center;
    color: #333;
    margin-top: 0;
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
                }
                @keyframes slideUpFade {
                    to {
                        transform: translateY(0);
                        opacity: 1;
                    }
                }
                .mb-popup-item .fallback-icon {
                    opacity: 0.4;
                    filter: grayscale(1);
                }
                .mb-popup-item .loaded-icon {
                    opacity: 1;
                    filter: none;
                }
                .mb-popup-item img {
                    transition: all 0.3s ease;
                    width: 32px;
                    height: 32px;
                }
                
                /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ ÐºÐ»Ð°ÑÑÐ° mb-touch-active Ð¸ swiping-up */
                .mb-icon-wrapper.mb-touch-active {
                    opacity: 0.8;
                    transform: scale(0.95);
                    transition: all 0.2s ease;
                }
                
                .mb-icon-wrapper.swiping-up {
                    transform: scale(0.92);
                }
                
                .mb-icon-wrapper.swiping-up::after {
                    content: '';
                    position: absolute;
                    top: -8px;
                    left: 50%;
                    transform: translateX(-50%);
                    width: 0;
                    height: 0;
                    border-left: 6px solid transparent;
                    border-right: 6px solid transparent;
                    border-bottom: 8px solid rgba(0, 123, 255, 0.6);
                    animation: pulse 1s infinite;
                }
                
                @keyframes pulse {
                    0% { opacity: 0.4; }
                    50% { opacity: 1; }
                    100% { opacity: 0.4; }
                }
                
                /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ° Ð¿Ð¾Ð¿Ð°Ð¿Ð° */
                .mb-popup-title {
                    margin: 0;
                    padding: 12px 20px 0;
                    text-align: center;
                    font-weight: 600;
                    font-size: 1rem;
                    color: #333;
                }
                
                /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "Ð½Ð°Ð·Ð°Ð´" */
                .mb-icon-wrapper.back-button-active {
                    position: relative;
                    transform: scale(1.05);
                    transition: all 0.3s ease;
                }
                
                .mb-icon-wrapper.back-button-active::after {
                    content: '';
                    position: absolute;
                    bottom: -8px;
                    left: 50%;
                    width: 6px;
                    height: 6px;
                    background-color: #007bff;
                    border-radius: 50%;
                    transform: translateX(-50%);
                    animation: pulse 1.5s infinite;
                }
                
                .mb-icon-wrapper.back-button-active .mb-nav-icon {
                    filter: brightness(1.2);
                    animation: backButtonPulse 2s infinite;
                }
                
                @keyframes backButtonPulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.1); }
                }
            `,document.head.appendChild(t)}}closePopup(){this.isPopupOpen&&(this.backdrop.style.opacity="0",this.backdrop.style.visibility="hidden",this.popupContainer.style.opacity="0",this.popupContainer.style.transform="translateX(-50%) translateY(100px)",setTimeout(()=>{this.popupContainer.style.visibility="hidden",this.isPopupOpen=!1,this.currentPopupConfig=null,this.currentIconId&&!document.querySelector(".modal-panel.show")&&window.MobileNavWheelPicker&&window.MobileNavWheelPicker.core&&(window.MobileNavWheelPicker.core.restoreIcon(this.currentIconId),this.currentIconId=null),this.unblockBodyScroll()},400))}blockBodyScroll(){const t=window.location.pathname;if(t.includes("/templates/create-new/")||t.includes("/templates/editor")||t.includes("/client/templates/create-new/")||t.includes("/client/templates/editor")){console.log("Ð‘Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° ÑÐºÑ€Ð¾Ð»Ð»Ð° Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð° Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€Ð°");return}this.scrollY=window.pageYOffset||document.documentElement.scrollTop,this.originalBodyOverflow=document.body.style.overflow,this.originalBodyPosition=document.body.style.position,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${this.scrollY}px`,document.body.style.width="100%",document.body.classList.add("popup-scroll-blocked")}unblockBodyScroll(){document.body.classList.contains("popup-scroll-blocked")&&(document.body.style.overflow=this.originalBodyOverflow,document.body.style.position=this.originalBodyPosition,document.body.style.top="",document.body.style.width="",document.body.classList.remove("popup-scroll-blocked"),this.scrollY>0&&window.scrollTo(0,this.scrollY),this.scrollY=0,this.originalBodyOverflow="",this.originalBodyPosition="")}blockHorizontalScroll(){return this.isUpSwipeInProgress}}class b{constructor(){this.storageKey="mobileNavState",this.routeToIconMap=this.createRouteMapping(),this.storageAvailable=this.checkStorageAvailability()}checkStorageAvailability(){try{const t="__storage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}}createRouteMapping(){return{"/":"home","/home":"home","/user/templates":"profile","/profile":"profile","/client/templates/categories":"create","/client/templates":"create","/client/projects":"create","/client/images":"create","/admin/dashboard":"admin","/admin":"admin","/games":"games","/email":"email"}}getIconForCurrentPage(){const t=window.location.pathname;if(this.routeToIconMap[t])return this.routeToIconMap[t];for(const[e,i]of Object.entries(this.routeToIconMap))if(e!=="/"&&t.startsWith(e))return i;return null}getPriorityIcon(){const t=this.getIconForCurrentPage();return t||"home"}clearExpiredData(){if(this.storageAvailable)try{const t=localStorage.getItem(this.storageKey);if(t){const e=JSON.parse(t);(!e||!e.timestamp||Date.now()-e.timestamp>24*60*60*1e3)&&localStorage.removeItem(this.storageKey)}}catch(t){console.warn("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐµ ÑƒÑÑ‚Ð°Ñ€ÐµÐ²ÑˆÐ¸Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð½Ð°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ð¸:",t);try{localStorage.removeItem(this.storageKey)}catch{}}}}class y{constructor(t,e){this.core=t,this.scroll=e}getScrollBounds(){const t=this.core.container.offsetWidth,e=this.core.iconsContainer.scrollWidth,i=e-t;return{containerWidth:t,scrollWidth:e,maxScrollLeft:i,currentScrollLeft:this.core.container.scrollLeft,sidePadding:this.core.sidePadding}}getMaxScrollForLastItem(){if(this.core.items.length===0)return 0;const t=this.core.items[this.core.items.length-1],e=this.core.container.offsetWidth,i=t.offsetLeft-e/2+t.offsetWidth/2;return Math.max(0,i)}setupIntersectionObserver(){if(!("IntersectionObserver"in window))return;const t={root:this.core.container,rootMargin:"0px",threshold:.5},e=new IntersectionObserver(i=>{i.forEach(o=>{o.isIntersecting?o.target.classList.add("mb-visible"):o.target.classList.remove("mb-visible")})},t);document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".mb-icon-wrapper").forEach(o=>e.observe(o))})}}class I{constructor(){this.core=new g,this.storage=new b,this.scroll=new v(this.core),this.popup=new w(this.core),this.utils=new y(this.core,this.scroll),this.events=new f(this.core,this.scroll,this.popup),window.MobileNavWheelPicker=this,this.initModalIntegration()}initModalIntegration(){document.addEventListener("modal.opened",t=>{var o,s;const e=(o=t.detail)==null?void 0:o.modalId,i=(s=t.detail)==null?void 0:s.sourceIconId;if(e&&i){console.log(`MobileNav: ÐœÐ¾Ð´Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ ${e} Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¾ Ð¸Ð· Ð¸ÐºÐ¾Ð½ÐºÐ¸ ${i}`);const n=document.querySelector(`[data-icon-id="${i}"]`);n&&n.classList.add("modal-source-active")}}),document.addEventListener("modal.closed",t=>{document.querySelectorAll(".modal-source-active").forEach(e=>{e.classList.remove("modal-source-active")})})}}document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>new I,100)});
